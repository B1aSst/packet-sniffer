from scapy.all import *


def print_arp(trame):  # prog qui check chaque trame
    print(trame.summary())  # résumé de la trame
    print(f"Ethernet: MAC Source : {trame[0][0].src}")
    print(f"Ethernet: MAC Destination : {trame[0][0].dst}")
    print(f"ARP : Sender MAC Address : {trame[0][1].hwsrc}")
    print(f"ARP : Sender IP Address : {trame[0][1].psrc}")
    print(f"ARP : Target MAC Address : {trame[0][1].hwdst}")
    print(f"ARP : Target IP Address : {trame[0][1].pdst}")
    print("\n")


carte = conf.iface  # définie la bonne carte réseau

print(f"On commence le 'sniffing' sur la carte {carte}:")
print("\n")
sniff(filter="arp", prn=print_arp, store=0, iface=carte, count=2)
